webpackJsonp([2],{EdC7:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAC4klEQVRoQ+2a8VEVQQzGv68CtQKlArQCpQK1ArECsAK1ArECpQK1AqECoQKgArWCOB+z59y7t3e3ye4KzpAZ/mJvL78km01yj+gkZvYIwEMAVyQvO70GbLVxUvgAwDMAjzP7CuIrgGOSZ63eWw2QFH8LYN+h1GcA71t4pgrAzF4A+ATgvkP5YekvAG9ICiYsYQAzk8WlfK28roEIASTLf6nVfPR8GMINYGYKl4tg2MwxK5yeRM5EBEAx+6qh9YetlJ08ieD6ORdAyjiyfi/Z8XrBC3AI4EMv7VNWOvLs7wXQRfTc8wLn2lOSugiLxQug8FGJ0E1IunRyLTYz66Z52vgOYMnCZqZ8fa+nF3p74ATA044A5yRzlezsK71nQClOJXMv+UhSqbpYvACyzo/i3f0LX5JUqi4WF4B2NbNeYeQOH+kTAdBF873YROUL90jKOC5xAyQvtD4LoUIu5IHBPGbWqqxwlw9jF4U8MIKoLa2PARyS1P0SkiqAFE5Ke++cF9xvPUPSVXnmCKsBEoS6NIGoIdEsaE6uAMhrRzVWbxZCOS1T06P7Ynyjag505m1WSmKqiQeSF1wlBsnTEgXX1oQAkpXV2ChkXLVLRiHlfmW0bxEPuQCS4poFubqmNSuO/i8YjViKZ6lFAGmUovGhq9ByKD5dquyk0eNqel0FSFbXEKs2VLw8OvgqLxYhFgHMTEqr7onMPr0K59ZLeUHMTrNnAVLYSPl/bfkpyKInlgCkfK/D6vXOCcm94pu44eTZq+jS+uwAOOsBM+s+/wmQXZLcmT63BXBLrT/oveWFHECrOj9g5NVHdFvrq9Bf2QBImefn6jY3u+DB+G6YAvTqd1sib/TOU4De4/MWIBvnYAqgzko1z20W1UjS81ruAG7AVYseUIpq+fm0B9/G+PF/uwe2BmBzpYRaRWWk3R4mDOx5niYZWz9LWOsH9D1Mf0NVqtK6d2+gdnJoKdViapox29T8ASR6AEDL9MXKAAAAAElFTkSuQmCC"},Rywg:function(t,e){},l7cM:function(t,e){},u66k:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n("woOf"),i=n.n(s),o=n("xVlr"),a=n("OOvn");function c(t,e){return Object(a.a)({headers:{Authorization:e},url:"/comments/create/change",method:"post",data:t})}var r={name:"CommentItem",props:{articleId:Number,comment:Object,index:Number,rootCommentCounts:Number},data:function(){return{placeholder:"你的评论...",commentShow:!1,commentShowIndex:"",reply:this.getEmptyReply()}},methods:{showComment:function(t,e){this.reply=this.getEmptyReply(),this.commentShowIndex!==t?(e?(this.placeholder="@"+e.nickname+" ",this.reply.toUserId=e.id):this.placeholder="你的评论...",this.commentShow=!0,this.commentShowIndex=t):(this.commentShow=!1,this.commentShowIndex="")},publishComment:function(){var t=this;t.reply.content&&c(t.reply,this.$store.state.token).then(function(e){e.success?(t.$message({type:"success",message:"评论成功",showClose:!0}),t.comment.childrens||(t.comment.childrens=[]),t.comment.childrens.unshift(e.data),t.$emit("commentCountsIncrement"),t.showComment(t.commentShowIndex)):t.$message({type:"error",message:e.msg,showClose:!0})}).catch(function(e){"error"!==e&&t.$message({type:"error",message:"评论失败",showClose:!0})})},getEmptyReply:function(){return{articleId:this.articleId,parent:this.comment.id,toUserId:"",content:""}}}},m={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"me-view-comment-item"},[n("div",{staticClass:"me-view-comment-author"},[n("a",{},[n("img",{staticClass:"me-view-picture",attrs:{src:t.comment.author.avatar}})]),t._v(" "),n("div",{staticClass:"me-view-info"},[n("span",{staticClass:"me-view-nickname"},[t._v(t._s(t.comment.author.nickname))]),t._v(" "),n("div",{staticClass:"me-view-meta"},[n("span",[t._v(t._s(t.rootCommentCounts-t.index)+"楼")]),t._v(" "),n("span",[t._v(t._s(t._f("format")(t.comment.createDate)))])])])]),t._v(" "),n("div",[n("p",{staticClass:"me-view-comment-content"},[t._v(t._s(t.comment.content))]),t._v(" "),n("div",{staticClass:"me-view-comment-tools"},[n("a",{staticClass:"me-view-comment-tool",on:{click:function(e){return t.showComment(-1,t.comment.author)}}},[n("i",{staticClass:"me-icon-comment"}),t._v("  评论\n      ")])]),t._v(" "),n("div",{staticClass:"me-reply-list"},[t._l(t.comment.childrens,function(e){return n("div",{key:e.id,staticClass:"me-reply-item"},[n("div",{staticStyle:{"font-size":"14px"}},[n("span",{staticClass:"me-reply-user"},[t._v(t._s(e.author.nickname)+":  ")]),t._v(" "),2==e.level?n("span",{staticClass:"me-reply-user"},[t._v("@"+t._s(e.toUser.nickname)+" ")]):t._e(),t._v(" "),n("span",[t._v(t._s(e.content))])]),t._v(" "),n("div",{staticClass:"me-view-meta"},[n("span",{staticStyle:{"padding-right":"10px"}},[t._v(t._s(t._f("format")(e.createDate)))])])])}),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.commentShow,expression:"commentShow"}],staticClass:"me-view-comment-write"},[n("el-input",{staticClass:"me-view-comment-text",staticStyle:{width:"90%"},attrs:{type:"input",placeholder:t.placeholder,resize:"none"},model:{value:t.reply.content,callback:function(e){t.$set(t.reply,"content",e)},expression:"reply.content"}}),t._v(" "),n("el-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"text"},on:{click:function(e){return t.publishComment()}}},[t._v("评论")])],1)],2)])])},staticRenderFns:[]};var l=n("VU/8")(r,m,!1,function(t){n("Rywg")},null,null).exports,u=n("viA7"),v=n("EdC7"),d=n.n(v),h={name:"BlogView",created:function(){this.getArticle()},watch:{$route:"getArticle"},data:function(){return{article:{id:"",title:"",commentCounts:0,viewCounts:0,summary:"",author:{},tags:[],category:{},createDate:"",editor:{value:"",toolbarsFlag:!1,subfield:!1,defaultOpen:"preview"}},comments:[],comment:{article:{},content:""}}},computed:{avatar:function(){var t=this.$store.state.avatar;return t.length>0?t:d.a},title:function(){return this.article.title+" - 文章 - 一乐博客"}},methods:{tagOrCategory:function(t,e){this.$router.push({path:"/"+t+"/"+e})},editArticle:function(){this.$router.push({path:"/write/"+this.article.id})},getArticle:function(){var t=this;Object(u.j)(t.$route.params.id).then(function(e){i()(t.article,e.data),t.article.editor.value=e.data.body.content,t.getCommentsByArticle()}).catch(function(e){"error"!==e&&t.$message({type:"error",message:"文章加载失败",showClose:!0})})},publishComment:function(){var t=this;t.comment.content&&(t.comment.article.id=t.article.id,c({articleId:t.article.id,content:t.comment.content},this.$store.state.token).then(function(e){e.success?(t.$message({type:"success",message:"评论成功",showClose:!0}),t.comment.content="",t.comments.unshift(e.data),t.commentCountsIncrement()):t.$message({type:"error",message:e.msg,showClose:!0})}).catch(function(e){"error"!==e&&t.$message({type:"error",message:"评论失败",showClose:!0})}))},getCommentsByArticle:function(){var t,e=this;(t=e.article.id,Object(a.a)({url:"/comments/article/"+t,method:"get"})).then(function(t){t.success?e.comments=t.data:e.$message({type:"error",message:"评论加载失败",showClose:!0})}).catch(function(t){"error"!==t&&e.$message({type:"error",message:"评论加载失败",showClose:!0})})},commentCountsIncrement:function(){this.article.commentCounts+=1}},components:{"markdown-editor":o.a,CommmentItem:l},beforeRouteEnter:function(t,e,n){window.document.body.style.backgroundColor="#fff",n()},beforeRouteLeave:function(t,e,n){window.document.body.style.backgroundColor="#f5f5f5",n()}},p={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"title",rawName:"v-title"}],staticClass:"me-view-body",attrs:{"data-title":t.title}},[n("el-container",{staticClass:"me-view-container"},[n("el-main",[n("div",{staticClass:"me-view-card"},[n("h1",{staticClass:"me-view-title"},[t._v(t._s(t.article.title))]),t._v(" "),n("div",{staticClass:"me-view-author"},[n("a",{},[n("img",{staticClass:"me-view-picture",attrs:{src:t.article.author.avatar}})]),t._v(" "),n("div",{staticClass:"me-view-info"},[n("span",[t._v(t._s(t.article.author.nickname))]),t._v(" "),n("div",{staticClass:"me-view-meta"},[n("span",[t._v(t._s(t._f("format")(t.article.createDate)))]),t._v(" "),n("span",[t._v("阅读   "+t._s(t.article.viewCounts))]),t._v(" "),n("span",[t._v("评论   "+t._s(t.article.commentCounts))])])]),t._v(" "),this.article.author.id==this.$store.state.id?n("el-button",{staticStyle:{position:"absolute",left:"60%"},attrs:{size:"mini",round:"",icon:"el-icon-edit"},on:{click:function(e){return t.editArticle()}}},[t._v("编辑")]):t._e()],1),t._v(" "),n("div",{staticClass:"me-view-content"},[n("markdown-editor",{attrs:{editor:t.article.editor}})],1),t._v(" "),n("div",{staticClass:"me-view-end"},[n("el-alert",{attrs:{title:"文章End...",type:"success",center:"",closable:!1}})],1),t._v(" "),n("div",{staticClass:"me-view-tag"},[t._v("\n          标签：\n          "),t._v(" "),t._l(t.article.tags,function(e){return n("el-button",{key:e.id,attrs:{size:"mini",type:"primary",round:"",plain:""},on:{click:function(n){return t.tagOrCategory("tag",e.id)}}},[t._v(t._s(e.tagName))])})],2),t._v(" "),n("div",{staticClass:"me-view-tag"},[t._v("\n          文章分类：\n          "),t._v(" "),n("el-button",{attrs:{size:"mini",type:"primary",round:"",plain:""},on:{click:function(e){return t.tagOrCategory("category",t.article.category.id)}}},[t._v(t._s(t.article.category.categoryName))])],1),t._v(" "),n("div",{staticClass:"me-view-comment"},[n("div",{staticClass:"me-view-comment-write"},[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:2}},[n("a",{},[n("img",{staticClass:"me-view-picture",attrs:{src:t.avatar}})])]),t._v(" "),n("el-col",{attrs:{span:22}},[n("el-input",{staticClass:"me-view-comment-text",attrs:{type:"textarea",autosize:{minRows:2},placeholder:"你的评论...",resize:"none"},model:{value:t.comment.content,callback:function(e){t.$set(t.comment,"content",e)},expression:"comment.content"}})],1)],1),t._v(" "),n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:2,offset:22}},[n("el-button",{attrs:{type:"text"},on:{click:function(e){return t.publishComment()}}},[t._v("评论")])],1)],1)],1),t._v(" "),n("div",{staticClass:"me-view-comment-title"},[n("span",[t._v(t._s(t.article.commentCounts)+" 条评论")])]),t._v(" "),t._l(t.comments,function(e,s){return n("commment-item",{key:e.id,attrs:{comment:e,articleId:t.article.id,index:s,rootCommentCounts:t.comments.length},on:{commentCountsIncrement:t.commentCountsIncrement}})})],2)])])],1)],1)},staticRenderFns:[]};var C=n("VU/8")(h,p,!1,function(t){n("l7cM")},null,null);e.default=C.exports}});
//# sourceMappingURL=2.9188448f9332b843451b.js.map